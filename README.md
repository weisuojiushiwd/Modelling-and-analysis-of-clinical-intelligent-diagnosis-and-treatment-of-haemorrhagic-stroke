# Modelling and analysis of clinical intelligent diagnosis and treatment of haemorrhagic stroke
 20届题目“华为杯”中国研究生数学建模竞赛

# 1 a)

分析：已知数据：入院首次影像检查流水号(SN)，发病到首次影像检查时间间隔，各时间点流水号及对应的HM_volume。
要解的问题:判断患者发病后48小时内是否发生血肿扩张事件。
对于同一个病患，随访i距发病所差小时数有公式可以推导。

# 1 b)

经过 1 a)，已将每个患者每次随访距离发病的时间与HM_volume联系了起来，根据题目定义和信息分析患者48小时内是否发生血肿扩张，以及发生HE的时间。并对48小时内是否发生HE进行预测。
第一部分，程序计算即可。
第二部分，因为要求的是48小时内是否发生HE。即发生HE的概率。这是一个典型的回归问题。
本题目标是找到一个函数既能高度拟合已知训练样本的100例患者，又能利用首次影像检测数据对未知样本的HE概率进行预测。
且本题是多自变量，单因变量问题。对于多自变量回归问题，线性回归的拟合能力较差。首先使用逻辑回归进行拟合。（还使用了随机森林算法）

任务分析：性别和血压分别可以通过赋值和拆分高低压的方式来保证与其他数据的一致性。

自变量部分：使用panda库的DataFrame来存储二维列表，先读取表1的“年龄”列到“营养神经”列，放在df1中；然后读取匹配表"HM_volume"到"ED_Cerebellum_L_Ratio"列（将SN码与每次就诊的结果进行匹配)，放在df2中；读取表3"original_shape_Elongation"到“NCCT_original_firstorder_Variance”列，放在df3中。
将df1,df2,df3按行拼接，构成自变量X。
将血肿扩张与否(0,1)作为因变量y。
使用逻辑回归训练，并画特征重要性柱状图。发现最重要的正面特征是冠心病史，最重要的负面特征是左侧大脑后动脉和左侧大脑前动脉上血肿的体积占比。发现逻辑回归对于寻找正面特征效果较差，遂改为使用随机森林。

处理方法与逻辑回归一致，画特征重要性柱状图。
重要性最高为止血治疗这一治疗方法，饮酒史为第二，与现有研究结论一致。
使用ROC曲线选择哪个模型作为最优解，发现随机森林ACC高，F1分数高。

# 2 a)

分析：画曲线，曲线拟合问题

自变量:发病至影像检查时间；因变量：水肿体积。
单自变量，单因变量问题，建立函数求解。

使用高斯模型进行拟合。因为原始数据中有些病人并不是完成了所有的随访，且每个病人的最后一次随访检查出的水肿体积相较于上一次均下降，没有出现增长的趋势，故可以认为，所有患者均可痊愈，故对ED_volume填0处理（这个假设我觉得并不合理，可能也是我没有获奖的原因吧）。

拟合后的结果如图。

# 2 b)

分析：聚类分析，拟合曲线，与第一问类似。

聚类：无监督学习K-means

# 2 c)

分析：对脑部水肿，有几种治疗方式，比较多组之间的差异问题。
方法1：方差分析ANOVA，显著性0.05的水平下，判断组间差异存在与否。
结果：降压治疗和降颅压治疗室友效果的。

方法2：MLP，使用简单的MLP针对每个方法能否降低脑部水肿建立一个预测模型。
使用评估指标(R2,MAE)来分析哪些方法最有效。发现降颅压，降压，镇静、镇痛治疗最有效。

# 2 d)

分析：施加治疗手段后，血肿体积和水肿体积的首次变化是最应该关注的指标，即特征重要性分析。
多自变量，单因变量问题。

方法:XGBoost，因为因变量并不是概率，建立一个基本的XGBoost模型，然后画出血肿、水肿变化特征重要性图。发现降颅压，止血，镇静镇痛都对血肿和水肿的快速缩小起到较好的效果。

针对血肿和水肿指标的相关性分析，使用斯皮尔曼相关系数。计算出结果0.5274

# 3 a)

分析：自变量：1、前100 个患者的个人史、疾病史、发病相关，2、首次影像结果。因变量：预测患者90 天mRS 评分。
方法：XGBoost，画特征重要性图，并预测mRS。

# 3 b)

对 3 a）的数据集进行增广，直接对先前模型进行优化。这部分做的不好。

# 3 c)

分析：相关性分析，斯皮尔曼相关系数热力图。

![image](https://github.com/weisuojiushiwd/Modelling-and-analysis-of-clinical-intelligent-diagnosis-and-treatment-of-haemorrhagic-stroke/assets/121271836/19b0771b-873a-4a31-a1dd-9f1c0a55be9d)

看图说话，言之成理。
